---
# Baseline configuration for Partner GCP E1 Device Group
# Partners have different security requirements than internet-facing

# Security Profile Group - moderate for trusted partners
baseline_security_profile_group:
  name: "Partner-Security-Profile"
  virus: "default"
  spyware: "default"
  vulnerability: "default"
  url_filtering: "alert-only"  # Less restrictive for partners
  file_blocking: "basic-file-blocking"
  wildfire: "default"

# Zone Protection - moderate thresholds
baseline_zone_protection:
  name: "Partner-Zone-Protection"
  settings:
    flood_tcp_syn: 25000
    flood_udp: 25000
    flood_icmpv4: 2500
    scan_protection: true

# Management Settings
baseline_management:
  permitted_ips:
    - "10.0.0.0/8"
    - "172.16.0.0/12"  # Partner networks
  services:
    https: true
    ssh: true
    http: false
    telnet: false
  idle_timeout: 15

# Session Settings - standard
baseline_session:
  tcp_timeout: 3600
  udp_timeout: 30
  tcp_timewait: 15

# GCP-specific NTP
baseline_ntp:
  primary_server: "metadata.google.internal"
  secondary_server: "1.pool.ntp.org"

# Partner-specific security rules
baseline_security_rules:
  - name: "Allow-Partner-Traffic"
    source_zone: ["partner"]
    destination_zone: ["trust"]
    source_address: ["Partner-Networks"]
    destination_address: ["App-Servers"]
    application: ["ssl", "web-browsing", "ssh"]
    service: ["application-default"]
    action: "allow"
    profile_group: "Partner-Security-Profile"
    log_end: true
    description: "Partner access to applications"

  - name: "Block-Partner-Internet"
    source_zone: ["partner"]
    destination_zone: ["untrust"]
    source_address: ["any"]
    destination_address: ["any"]
    application: ["any"]
    service: ["any"]
    action: "deny"
    log_end: true
    description: "Partners cannot access internet directly"
